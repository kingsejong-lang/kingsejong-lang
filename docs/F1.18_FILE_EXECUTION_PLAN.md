# F1.18: íŒŒì¼ ì‹¤í–‰ ëª¨ë“œ êµ¬í˜„ ê³„íš

> **Feature**: File Execution Mode
> **ìš°ì„ ìˆœìœ„**: HIGH
> **ìƒíƒœ**: ğŸ“ ê³„íš
> **ì‘ì„±ì¼**: 2025-11-09

## ê°œìš”

KingSejong ì–¸ì–´ ì†ŒìŠ¤ íŒŒì¼ (`.ksj`)ì„ ì½ê³  ì‹¤í–‰í•˜ëŠ” íŒŒì¼ ì‹¤í–‰ ëª¨ë“œë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‘ì„±í•˜ì—¬ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.

## ëª©í‘œ

- `.ksj` íŒŒì¼ ì½ê¸° ë° íŒŒì‹±
- íŒŒì¼ ë‚´ìš© ì‹¤í–‰
- ì‹¤í–‰ ê²°ê³¼ ì¶œë ¥
- ì—ëŸ¬ ì²˜ë¦¬ ë° í‘œì‹œ
- ëª…ë ¹ì¤„ ì¸ì ì²˜ë¦¬

## í•µì‹¬ ê¸°ëŠ¥

### 1. íŒŒì¼ ì‹¤í–‰ ëª¨ë“œ

```bash
# íŒŒì¼ ì‹¤í–‰
./kingsejong script.ksj

# íŒŒì¼ì´ ì—†ëŠ” ê²½ìš°
./kingsejong nonexistent.ksj
ì—ëŸ¬: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: nonexistent.ksj
```

### 2. ì‹¤í–‰ ê²°ê³¼

```ksj
// examples/hello.ksj
ì¶œë ¥("ì•ˆë…•í•˜ì„¸ìš”, KingSejong!")

ì •ìˆ˜ x = 10
ì •ìˆ˜ y = 20
ì¶œë ¥("x + y =", x + y)
```

ì‹¤í–‰:
```bash
$ ./kingsejong examples/hello.ksj
ì•ˆë…•í•˜ì„¸ìš”, KingSejong!
x + y = 30
```

### 3. ì—ëŸ¬ ì²˜ë¦¬

```ksj
// error.ksj
ì •ìˆ˜ x = 10 / 0
```

ì‹¤í–‰:
```bash
$ ./kingsejong error.ksj
ì—ëŸ¬: 0ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
íŒŒì¼: error.ksj
ìœ„ì¹˜: ë¼ì¸ 1
```

### 4. ì¢…ë£Œ ì½”ë“œ

```bash
# ì„±ê³µ
./kingsejong script.ksj
echo $?  # 0

# íŒŒì¼ ì—†ìŒ
./kingsejong nonexistent.ksj
echo $?  # 1

# ì‹¤í–‰ ì—ëŸ¬
./kingsejong error.ksj
echo $?  # 1
```

## êµ¬í˜„ ì„¤ê³„

### ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   main.cpp  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ executeFile â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”œâ”€â”€> íŒŒì¼ ì½ê¸° (std::ifstream)
      â”‚
      â”œâ”€â”€> Lexer   â”€â”€> Token ìŠ¤íŠ¸ë¦¼
      â”‚
      â”œâ”€â”€> Parser  â”€â”€> AST
      â”‚
      â””â”€â”€> Evaluator â”€â”€> ì‹¤í–‰ ê²°ê³¼
```

### main.cpp ìˆ˜ì •

```cpp
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include "repl/Repl.h"
#include "lexer/Lexer.h"
#include "parser/Parser.h"
#include "evaluator/Evaluator.h"
#include "evaluator/Environment.h"
#include "evaluator/Builtin.h"

/**
 * @brief íŒŒì¼ì„ ì½ê³  ì‹¤í–‰
 * @param filename ì‹¤í–‰í•  íŒŒì¼ ê²½ë¡œ
 * @return ì¢…ë£Œ ì½”ë“œ (0: ì„±ê³µ, 1: ì‹¤íŒ¨)
 */
int executeFile(const std::string& filename)
{
    // 1. íŒŒì¼ ì½ê¸°
    std::ifstream file(filename);
    if (!file.is_open())
    {
        std::cerr << "ì—ëŸ¬: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: " << filename << "\n";
        return 1;
    }

    std::stringstream buffer;
    buffer << file.rdbuf();
    std::string source = buffer.str();
    file.close();

    try
    {
        // 2. Lexer
        kingsejong::lexer::Lexer lexer(source);

        // 3. Parser
        kingsejong::parser::Parser parser(lexer);
        auto program = parser.parseProgram();

        // íŒŒì„œ ì—ëŸ¬ í™•ì¸
        if (!parser.errors().empty())
        {
            std::cerr << "íŒŒì„œ ì—ëŸ¬:\n";
            for (const auto& err : parser.errors())
            {
                std::cerr << "  " << err << "\n";
            }
            std::cerr << "íŒŒì¼: " << filename << "\n";
            return 1;
        }

        // 4. í™˜ê²½ ìƒì„±
        auto env = std::make_shared<kingsejong::evaluator::Environment>();

        // 5. Evaluator
        kingsejong::evaluator::Evaluator evaluator(env);
        evaluator.evalProgram(program.get());

        return 0;
    }
    catch (const std::exception& e)
    {
        std::cerr << "ì—ëŸ¬: " << e.what() << "\n";
        std::cerr << "íŒŒì¼: " << filename << "\n";
        return 1;
    }
}

int main(int argc, char* argv[])
{
    // ë‚´ì¥ í•¨ìˆ˜ ë“±ë¡
    kingsejong::evaluator::Builtin::registerAllBuiltins();

    if (argc == 1)
    {
        // REPL ëª¨ë“œ
        kingsejong::repl::Repl repl;
        repl.start();
        return 0;
    }
    else if (argc == 2)
    {
        // íŒŒì¼ ì‹¤í–‰ ëª¨ë“œ
        std::string filename = argv[1];
        return executeFile(filename);
    }
    else
    {
        // ì˜ëª»ëœ ì‚¬ìš©ë²•
        std::cerr << "ì‚¬ìš©ë²•: kingsejong [íŒŒì¼ëª…]\n";
        std::cerr << "\n";
        std::cerr << "  kingsejong          - REPL ëª¨ë“œë¡œ ì‹¤í–‰\n";
        std::cerr << "  kingsejong íŒŒì¼.ksj  - íŒŒì¼ ì‹¤í–‰\n";
        return 1;
    }
}
```

## ì˜ˆì œ íŒŒì¼

### examples/hello.ksj

```ksj
// ê¸°ë³¸ ì¶œë ¥
ì¶œë ¥("ì•ˆë…•í•˜ì„¸ìš”, KingSejong!")
ì¶œë ¥("í•œê¸€ë¡œ í”„ë¡œê·¸ë˜ë°í•˜ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ ì–¸ì–´")
```

### examples/calculator.ksj

```ksj
// ê°„ë‹¨í•œ ê³„ì‚°ê¸°
ì •ìˆ˜ a = 10
ì •ìˆ˜ b = 5

ì¶œë ¥("a =", a)
ì¶œë ¥("b =", b)
ì¶œë ¥("a + b =", a + b)
ì¶œë ¥("a - b =", a - b)
ì¶œë ¥("a * b =", a * b)
ì¶œë ¥("a / b =", a / b)
```

### examples/fibonacci.ksj

```ksj
// í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ (ì¬ê·€)
ì •ìˆ˜ í”¼ë³´ë‚˜ì¹˜ = í•¨ìˆ˜(n) {
    ë§Œì•½ (n <= 1) {
        ë°˜í™˜ n
    }
    ë°˜í™˜ í”¼ë³´ë‚˜ì¹˜(n-1) + í”¼ë³´ë‚˜ì¹˜(n-2)
}

ì¶œë ¥("í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´:")
ì •ìˆ˜ i = 0
10ë²ˆ ë°˜ë³µí•œë‹¤ {
    ì¶œë ¥("F(", i, ") =", í”¼ë³´ë‚˜ì¹˜(i))
    i = i + 1
}
```

### examples/loop.ksj

```ksj
// ë°˜ë³µë¬¸ ì˜ˆì œ
ì¶œë ¥("=== ë²”ìœ„ for ë°˜ë³µ ===")
ì •ìˆ˜ i
iê°€ 1ë¶€í„° 10ê¹Œì§€ {
    ì¶œë ¥(i)
}

ì¶œë ¥("\n=== Në²ˆ ë°˜ë³µ ===")
ì •ìˆ˜ count = 0
5ë²ˆ ë°˜ë³µí•œë‹¤ {
    count = count + 1
    ì¶œë ¥("ë°˜ë³µ", count)
}
```

### examples/function.ksj

```ksj
// í•¨ìˆ˜ ì˜ˆì œ
ì •ìˆ˜ í•© = í•¨ìˆ˜(a, b) {
    ë°˜í™˜ a + b
}

ì •ìˆ˜ ê³± = í•¨ìˆ˜(a, b) {
    ë°˜í™˜ a * b
}

ì¶œë ¥("3 + 5 =", í•©(3, 5))
ì¶œë ¥("3 * 5 =", ê³±(3, 5))

// ê³ ì°¨ í•¨ìˆ˜
ì •ìˆ˜ ì ìš© = í•¨ìˆ˜(f, x, y) {
    ë°˜í™˜ f(x, y)
}

ì¶œë ¥("ì ìš©(í•©, 10, 20) =", ì ìš©(í•©, 10, 20))
```

## í…ŒìŠ¤íŠ¸ ê³„íš

### ìˆ˜ë™ í…ŒìŠ¤íŠ¸

1. **ê¸°ë³¸ ì‹¤í–‰**
   ```bash
   ./kingsejong examples/hello.ksj
   # ì¶œë ¥: ì•ˆë…•í•˜ì„¸ìš”, KingSejong!
   ```

2. **ë³€ìˆ˜ ë° ì—°ì‚°**
   ```bash
   ./kingsejong examples/calculator.ksj
   # ì¶œë ¥: ê³„ì‚° ê²°ê³¼ë“¤
   ```

3. **í•¨ìˆ˜ ì‹¤í–‰**
   ```bash
   ./kingsejong examples/fibonacci.ksj
   # ì¶œë ¥: F(0) = 0, F(1) = 1, ...
   ```

4. **ë°˜ë³µë¬¸ ì‹¤í–‰**
   ```bash
   ./kingsejong examples/loop.ksj
   # ì¶œë ¥: 1, 2, 3, ..., 10
   ```

5. **íŒŒì¼ ì—†ìŒ ì—ëŸ¬**
   ```bash
   ./kingsejong nonexistent.ksj
   # ì—ëŸ¬: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
   ```

6. **êµ¬ë¬¸ ì—ëŸ¬**
   ```bash
   # error.ksj: ì •ìˆ˜ x =
   ./kingsejong error.ksj
   # íŒŒì„œ ì—ëŸ¬: ...
   ```

7. **ì‹¤í–‰ ì—ëŸ¬**
   ```bash
   # runtime_error.ksj: ì •ìˆ˜ x = 10 / 0
   ./kingsejong runtime_error.ksj
   # ì—ëŸ¬: 0ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
   ```

### í†µí•© í…ŒìŠ¤íŠ¸

ëª¨ë“  ì˜ˆì œ íŒŒì¼ì´ ì˜¬ë°”ë¥´ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸:

```bash
for file in examples/*.ksj; do
    echo "ì‹¤í–‰: $file"
    ./kingsejong "$file"
    echo "ì¢…ë£Œ ì½”ë“œ: $?"
    echo "---"
done
```

## ì™„ë£Œ ì¡°ê±´

- [x] executeFile() í•¨ìˆ˜ êµ¬í˜„
- [x] íŒŒì¼ ì½ê¸° ë° ì—ëŸ¬ ì²˜ë¦¬
- [x] main.cpp argc ì²˜ë¦¬
- [x] examples/ ë””ë ‰í† ë¦¬ ìƒì„±
- [x] ì˜ˆì œ íŒŒì¼ ì‘ì„± (5ê°œ ì´ìƒ)
  - [x] hello.ksj
  - [x] calculator.ksj
  - [x] fibonacci.ksj
  - [x] loop.ksj
  - [x] function.ksj
- [x] ëª¨ë“  ì˜ˆì œ ì‹¤í–‰ ì„±ê³µ
- [x] ì—ëŸ¬ ì²˜ë¦¬ ë™ì‘ í™•ì¸
- [x] README ì—…ë°ì´íŠ¸
- [x] ë¬¸ì„œ ì—…ë°ì´íŠ¸

## ë‹¤ìŒ ë‹¨ê³„

F1.18 ì™„ë£Œ í›„:
- **F1.19**: ì¶”ê°€ ì˜ˆì œ í”„ë¡œê·¸ë¨ ì‘ì„± (10ê°œ ì´ìƒ)
- **Phase 2**: ë°°ì—´, ë¬¸ìì—´ ë©”ì„œë“œ, í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±

## ì°¸ê³  ì‚¬í•­

### ê¸°ìˆ ì  ê³ ë ¤ì‚¬í•­

1. **íŒŒì¼ ì¸ì½”ë”©**
   - UTF-8 ì¸ì½”ë”© í•„ìˆ˜
   - BOM ì²˜ë¦¬ (ì„ íƒì‚¬í•­)

2. **ì—ëŸ¬ ë©”ì‹œì§€**
   - íŒŒì¼ëª… í¬í•¨
   - ë¼ì¸ ë²ˆí˜¸ í‘œì‹œ (í–¥í›„)
   - í•œê¸€ ì—ëŸ¬ ë©”ì‹œì§€

3. **ì¢…ë£Œ ì½”ë“œ**
   - 0: ì„±ê³µ
   - 1: ì—ëŸ¬ (íŒŒì¼ ì—†ìŒ, íŒŒì„œ ì—ëŸ¬, ì‹¤í–‰ ì—ëŸ¬)

4. **ì„±ëŠ¥**
   - íŒŒì¼ í¬ê¸° ì œí•œ ì—†ìŒ
   - ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ íŒŒì¼ ì½ê¸°

### í–¥í›„ ê°œì„ ì‚¬í•­ (Phase 2+)

- ëª…ë ¹ì¤„ ì¸ì ì „ë‹¬ (`argv`)
- í‘œì¤€ ì…ë ¥ ì§€ì› (`-` ë˜ëŠ” stdin)
- ë””ë²„ê·¸ ëª¨ë“œ (`--debug`)
- ìƒì„¸ ì¶œë ¥ ëª¨ë“œ (`--verbose`)
- AST ì¶œë ¥ ëª¨ë“œ (`--ast`)
- ì‹¤í–‰ ì‹œê°„ ì¸¡ì • (`--time`)

## êµ¬í˜„ ìˆœì„œ

1. **Step 1**: F1.18_FILE_EXECUTION_PLAN.md ì‘ì„± âœ…
2. **Step 2**: examples/ ë””ë ‰í† ë¦¬ ë° ì˜ˆì œ íŒŒì¼ ìƒì„±
3. **Step 3**: main.cpp executeFile() í•¨ìˆ˜ êµ¬í˜„
4. **Step 4**: íŒŒì¼ ì½ê¸° ë° ì—ëŸ¬ ì²˜ë¦¬
5. **Step 5**: ëª¨ë“  ì˜ˆì œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸
6. **Step 6**: README ì—…ë°ì´íŠ¸
7. **Step 7**: ì»¤ë°‹ ë° PR

---

**ì‘ì„±ì**: Claude
**ìµœì¢… ìˆ˜ì •**: 2025-11-09
